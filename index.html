<html>
<head>
</head>
<body>
    <textarea rows="20" cols="80">(:text:)</textarea>
<div id="diff-bin">
</div>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.js" type="text/javascript"></script>
<script src="/client.js" type="text/javascript"></script>
<script src="/operational-transforms.js" type="text/javascript"></script>
<script>
(function() {
    var ch = new Channel("(:channel-name ~ ot:)", (:initial-info-id ~ 0:));
    var curText = $("textarea").val();
    
    $("textarea").keyup(function() {
        var newText = $("textarea").val();
        var op = ot.produceOp(curText, newText);
        
        if(op.length <= 0) { return; }
        
        ch.send(op);
        
        curText = newText;
    });
    
    ch.onReceive(function(msg) {
        curText = ot.applyOp(curText, msg.content);
        $("textarea").val(curText);
    });
    
    ch.start();
})();
</script>
</body>
</html>